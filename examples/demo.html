<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Example on How to User Narwhal</title>
    <link rel="stylesheet" href="../examples/css/bootstrap.min.css">
    <link rel="stylesheet" href="../examples/css/narwhal.css">
    <script src="../examples/js/vendor/d3.js"></script>
    <script src="../examples/js/vendor/jquery.js"></script>
    <script src="../examples/js/vendor/lodash.js"></script>

    <script src="../src/scripts/core/narwhal-utils.js" ></script>
    <script src="../src/scripts/core/axis/ordinal-scale-axis.js" ></script>
    <script src="../src/scripts/core/axis/time-scale-axis.js" ></script>
    <script src="../src/scripts/core/axis/axis-scale-factory.js" ></script>
    <script src="../src/scripts/core/narwhal.js"></script>
    <script src="../src/scripts/core/cartesian.js"></script>
    <script src="../src/scripts/core/horizontal-frame.js"></script>
    <script src="../src/scripts/visualizations/line.js"></script>
    <script src="../src/scripts/visualizations/tooltip.js"></script>
    <script src="../src/scripts/visualizations/stack-tooltip.js"></script>
    <script src="../src/scripts/visualizations/column.js"></script>
    <script src="../src/scripts/visualizations/bar.js"></script>
    <script src="../src/scripts/connectors/csv.js" ></script>

    <style>
        .chart {
            width: 960px;
            margin: 10px 0;
        }

        .chart svg {
            border: solid 1px red;

        }

        .dot {
            fill: red;
        }

        .legend {
            height: 1.5em;
        }


    </style>

</head>
<body>

<div class="container">
    <h2>Narwhal</h2>

    <div class="legend"></div>
    <div class="chart"></div>


</div>
<script>

Narwhal.export('scatter', function (data, layer) {

    var x = _.bind(function (d) { return this.xScale(d.x); }, this);
    var y = _.bind(function (d) { return this.yScale(d.y); }, this);

    layer.selectAll('dot')
        .data(data)
        .enter().append('circle')
            .attr('r', 4)
            .attr('cx', x)
            .attr('cy', y);
});


// var csvData = 'month,cost,revenue,profit\njan,165,346,181\nfeb,93,340,247\nmar,64,321,257\napr,54,317,263\nmay,189,357,168\njun,80,303,223\njul,196,308,112\naug,165,352,187\nsep,80,359,279\noct,166,335,169\nnov,82,290,208\ndec,177,273,96';

// var connector = new Narwhal.connectors.Csv(csvData);
// connector.dimension('month');


var coq3 = [{"x":"2000-01-01T15:00:00.000Z","y":29.76826026832544},{"x":"2000-01-01T15:20:00.000Z","y":36.93441657547385},{"x":"2000-01-01T15:40:00.000Z","y":37.06631074384878},{"x":"2000-01-01T16:00:00.000Z","y":37.695803120659065},{"x":"2000-01-01T16:20:00.000Z","y":38.33362848964466},{"x":"2000-01-01T16:40:00.000Z","y":38.81147681455478},{"x":"2000-01-01T17:00:00.000Z","y":36.28339307919614},{"x":"2000-01-01T17:20:00.000Z","y":33.70994007431792},{"x":"2000-01-01T17:40:00.000Z","y":36.99368586115874},{"x":"2000-01-01T18:00:00.000Z","y":36.966559349619445},{"x":"2000-01-01T18:20:00.000Z","y":33.75661561571867},{"x":"2000-01-01T18:40:00.000Z","y":34.54793195450393},{"x":"2000-01-01T19:00:00.000Z","y":38.09743289957558},{"x":"2000-01-01T19:20:00.000Z","y":37.03862813861582},{"x":"2000-01-01T19:40:00.000Z","y":39.05304932254238},{"x":"2000-01-01T20:00:00.000Z","y":37.108836761512556},{"x":"2000-01-01T20:20:00.000Z","y":35.773945870676684},{"x":"2000-01-01T20:40:00.000Z","y":38.447454279004454},{"x":"2000-01-01T21:00:00.000Z","y":37.318249826042475},{"x":"2000-01-01T21:20:00.000Z","y":34.096602528905734},{"x":"2000-01-01T21:40:00.000Z","y":37.618738917881466},{"x":"2000-01-01T22:00:00.000Z","y":33.64409641108412},{"x":"2000-01-01T22:20:00.000Z","y":39.407802809131766},{"x":"2000-01-01T22:40:00.000Z","y":38.51248232405078},{"x":"2000-01-01T23:00:00.000Z","y":37.668242721359064},{"x":"2000-01-01T23:20:00.000Z","y":34.91517755811294},{"x":"2000-01-01T23:40:00.000Z","y":35.148413526894956},{"x":"2000-01-02T00:00:00.000Z","y":35.158669763603896},{"x":"2000-01-02T00:20:00.000Z","y":37.715383405225566},{"x":"2000-01-02T00:40:00.000Z"},{"x":"2000-01-02T01:00:00.000Z"},{"x":"2000-01-02T01:20:00.000Z"},{"x":"2000-01-02T01:40:00.000Z"},{"x":"2000-01-02T02:00:00.000Z"},{"x":"2000-01-02T02:20:00.000Z"},{"x":"2000-01-02T02:40:00.000Z"},{"x":"2000-01-02T03:00:00.000Z"},{"x":"2000-01-02T03:20:00.000Z"},{"x":"2000-01-02T03:40:00.000Z"},{"x":"2000-01-02T04:00:00.000Z"},{"x":"2000-01-02T04:20:00.000Z"},{"x":"2000-01-02T04:40:00.000Z"},{"x":"2000-01-02T05:00:00.000Z"},{"x":"2000-01-02T05:20:00.000Z"},{"x":"2000-01-02T05:40:00.000Z"},{"x":"2000-01-02T06:00:00.000Z"}];

var coq2 = [{"x":"2000-01-01T15:20:00.000Z","y":8.750524467985066},{"x":"2000-01-01T15:40:00.000Z","y":8.511846628761873},{"x":"2000-01-01T16:00:00.000Z","y":8.474640945886037},{"x":"2000-01-01T16:20:00.000Z","y":8.602664831980313},{"x":"2000-01-01T16:40:00.000Z","y":12.085011316559388},{"x":"2000-01-01T17:00:00.000Z","y":5.631733098408553},{"x":"2000-01-01T17:20:00.000Z","y":6.274347413934429},{"x":"2000-01-01T17:40:00.000Z","y":8.38703799831756},{"x":"2000-01-01T18:00:00.000Z","y":3.215259285513035},{"x":"2000-01-01T18:20:00.000Z","y":4.887935609429157},{"x":"2000-01-01T18:40:00.000Z","y":3.0303493497651317},{"x":"2000-01-01T19:00:00.000Z","y":5.574008231001372},{"x":"2000-01-01T19:20:00.000Z","y":9.67443999174803},{"x":"2000-01-01T19:40:00.000Z","y":5.45739714410341},{"x":"2000-01-01T20:00:00.000Z","y":3.2317814657093393},{"x":"2000-01-01T20:20:00.000Z","y":6.857160676286782},{"x":"2000-01-01T20:40:00.000Z","y":11.594130699828025},{"x":"2000-01-01T21:00:00.000Z","y":5.361265740157236},{"x":"2000-01-01T21:20:00.000Z","y":9.177852414860396},{"x":"2000-01-01T21:40:00.000Z","y":9.707981758003147},{"x":"2000-01-01T22:00:00.000Z","y":7.744450208185668},{"x":"2000-01-01T22:20:00.000Z","y":9.946209734000206},{"x":"2000-01-01T22:40:00.000Z","y":8.910853017485607},{"x":"2000-01-01T23:00:00.000Z","y":15.634354425706},{"x":"2000-01-01T23:20:00.000Z","y":11.809489078756034},{"x":"2000-01-01T23:40:00.000Z","y":5.576441196229759},{"x":"2000-01-02T00:00:00.000Z","y":6.797766478670894},{"x":"2000-01-02T00:20:00.000Z","y":11.194275232670769},{"x":"2000-01-02T00:40:00.000Z","y":2.7390482271008594},{"x":"2000-01-02T01:00:00.000Z","y":10.288753865863601},{"x":"2000-01-02T01:20:00.000Z","y":7.375899484802517},{"x":"2000-01-02T01:40:00.000Z","y":4.905950825380188},{"x":"2000-01-02T02:00:00.000Z","y":5.334054305100992},{"x":"2000-01-02T02:20:00.000Z","y":6.715087744107983},{"x":"2000-01-02T02:40:00.000Z","y":11.266682882542824},{"x":"2000-01-02T03:00:00.000Z","y":3.1543111026415005},{"x":"2000-01-02T03:20:00.000Z","y":7.523403457963866},{"x":"2000-01-02T03:40:00.000Z","y":5.759804356836803},{"x":"2000-01-02T04:00:00.000Z","y":4.084169023623005},{"x":"2000-01-02T04:20:00.000Z","y":6.046312681005389},{"x":"2000-01-02T04:40:00.000Z","y":5.7536208605464125},{"x":"2000-01-02T05:00:00.000Z","y":11.440014904163707},{"x":"2000-01-02T05:20:00.000Z","y":4.130860858193969},{"x":"2000-01-02T05:40:00.000Z","y":6.003218841857461},{"x":"2000-01-02T06:00:00.000Z","y":8.452375237189301},{"x":"2000-01-02T06:20:00.000Z","y":8.019937132514915},{"x":"2000-01-02T06:40:00.000Z","y":12.053436345837909},{"x":"2000-01-02T07:00:00.000Z","y":7.6236515895903025},{"x":"2000-01-02T07:20:00.000Z","y":2.4786144012646574},{"x":"2000-01-02T07:40:00.000Z","y":9.823426551542067},{"x":"2000-01-02T08:00:00.000Z","y":10.46185309338096},{"x":"2000-01-02T08:20:00.000Z","y":5.863644778445298},{"x":"2000-01-02T08:40:00.000Z","y":7.4611883541217665},{"x":"2000-01-02T09:00:00.000Z","y":10.824665036008433},{"x":"2000-01-02T09:20:00.000Z","y":6.012407189736198},{"x":"2000-01-02T09:40:00.000Z","y":4.038597415444293},{"x":"2000-01-02T10:00:00.000Z","y":8.446553188409169},{"x":"2000-01-02T10:20:00.000Z","y":9.58703696148822},{"x":"2000-01-02T10:40:00.000Z","y":3.9040370863551743},{"x":"2000-01-02T11:00:00.000Z","y":8.921083851810423},{"x":"2000-01-02T11:20:00.000Z","y":9.082713168458007},{"x":"2000-01-02T11:40:00.000Z","y":9.144730249257456},{"x":"2000-01-02T12:00:00.000Z","y":12.329386199135591},{"x":"2000-01-02T12:20:00.000Z","y":3.8488854697803205},{"x":"2000-01-02T12:40:00.000Z","y":5.396519866237725},{"x":"2000-01-02T13:00:00.000Z","y":4.576802632814228},{"x":"2000-01-02T13:20:00.000Z","y":7.263524587386936},{"x":"2000-01-02T13:40:00.000Z","y":11.628872245210793},{"x":"2000-01-02T14:00:00.000Z","y":5.936791104174695},{"x":"2000-01-02T14:20:00.000Z","y":4.3181037728703195},{"x":"2000-01-02T14:40:00.000Z","y":8.79387901184549},{"x":"2000-01-02T15:00:00.000Z","y":5.873709024626926},{"x":"2000-01-02T15:20:00.000Z","y":11.287891262407378},{"x":"2000-01-02T15:40:00.000Z","y":6.047207975846838},{"x":"2000-01-02T16:00:00.000Z","y":10.87319437140863},{"x":"2000-01-02T16:20:00.000Z","y":5.88765968109033},{"x":"2000-01-02T16:40:00.000Z","y":7.275860470262899},{"x":"2000-01-02T17:00:00.000Z","y":6.84773339954134},{"x":"2000-01-02T17:20:00.000Z","y":2.736756790357475},{"x":"2000-01-02T17:40:00.000Z","y":3.977802892001421},{"x":"2000-01-02T18:00:00.000Z","y":8.941685268700006},{"x":"2000-01-02T18:20:00.000Z","y":10.586867279644263},{"x":"2000-01-02T18:40:00.000Z","y":4.3658269991477},{"x":"2000-01-02T19:00:00.000Z","y":9.914005250118613},{"x":"2000-01-02T19:20:00.000Z","y":9.131429817804566},{"x":"2000-01-02T19:40:00.000Z","y":8.472545853915072},{"x":"2000-01-02T20:00:00.000Z","y":6.495190835244188},{"x":"2000-01-02T20:20:00.000Z","y":3.492284623037982},{"x":"2000-01-02T20:40:00.000Z","y":16.13068068414627},{"x":"2000-01-02T21:00:00.000Z","y":12.605290498795206},{"x":"2000-01-02T21:20:00.000Z","y":9.3647745879166},{"x":"2000-01-02T21:40:00.000Z","y":7.815003482110811},{"x":"2000-01-02T22:00:00.000Z","y":4.372504235729153},{"x":"2000-01-02T22:20:00.000Z","y":7.433421976369548},{"x":"2000-01-02T22:40:00.000Z","y":10.518105772226882},{"x":"2000-01-02T23:00:00.000Z","y":7.717257193375588},{"x":"2000-01-02T23:20:00.000Z","y":5.270083961019225},{"x":"2000-01-02T23:40:00.000Z","y":6.917170291438744},{"x":"2000-01-03T00:00:00.000Z","y":5.758433887743081},{"x":"2000-01-03T00:20:00.000Z","y":4.941035038756894},{"x":"2000-01-03T00:40:00.000Z","y":6.954056903233422},{"x":"2000-01-03T01:00:00.000Z","y":7.0162445464712135},{"x":"2000-01-03T01:20:00.000Z","y":10.407201589211741},{"x":"2000-01-03T01:40:00.000Z","y":3.839706885026338},{"x":"2000-01-03T02:00:00.000Z","y":8.725842080839112},{"x":"2000-01-03T02:20:00.000Z","y":8.62278709670926},{"x":"2000-01-03T02:40:00.000Z","y":13.624931149308892},{"x":"2000-01-03T03:00:00.000Z","y":6.883213335561138},{"x":"2000-01-03T03:20:00.000Z","y":10.550383417569343},{"x":"2000-01-03T03:40:00.000Z","y":14.016792727125146},{"x":"2000-01-03T04:00:00.000Z","y":11.812763716807524},{"x":"2000-01-03T04:20:00.000Z","y":8.985520844741345},{"x":"2000-01-03T04:40:00.000Z","y":9.815836896020713},{"x":"2000-01-03T05:00:00.000Z","y":9.868461002020666},{"x":"2000-01-03T05:20:00.000Z","y":11.249930994281431},{"x":"2000-01-03T05:40:00.000Z","y":5.047006410492486},{"x":"2000-01-03T06:00:00.000Z","y":11.585200051961642},{"x":"2000-01-03T06:20:00.000Z","y":8.008730914353741},{"x":"2000-01-03T06:40:00.000Z","y":6.654137804378124},{"x":"2000-01-03T07:00:00.000Z","y":1.6644704617819315},{"x":"2000-01-03T07:20:00.000Z","y":14.70427961610158},{"x":"2000-01-03T07:40:00.000Z","y":7.0764325754509585},{"x":"2000-01-03T08:00:00.000Z","y":9.486807301876325},{"x":"2000-01-03T08:20:00.000Z","y":5.516777599839074},{"x":"2000-01-03T08:40:00.000Z","y":10.702567679752413}, {"x":"2000-01-04T08:40:00.000Z","y":11.702567679752413}]


var rand = function () { return Math.random() * 100; };
var simpleData = [
    { x: new Date('2000-01-01 10:00'), y: 10 },
    { x: new Date('2000-01-01 11:00'), y: 20 },
    { x: new Date('2000-01-02 10:00'), y: 40 },
    { x: new Date('2000-01-02 11:00'), y: 30 },
];

var cats = ['XX', 'A', 'B', 'C', 'wer', 'Ecb', 'F', 'G', 'H', 'I']


var config = {
    el: '.chart',
    chart: {
        animations: true,

    },

    xAxis: {
        firstAndLast: false,
        maxTicks: 10,

        // categories: cats,
        title: 'Type',
        innerTickSize: 6,
        linearDomain: true,
        labels: {
            formatter: function (d) {
                return _.isDate(d) ? d.toTimeString().match(/\d\d:\d\d/)[0] : d;
            }
        }
    },

    yAxis: {
        smartAxis: false,
        // min: null,
        // max: 15000,
        title: 'Values',

        labels: {
            format: ',d'
        }
    },

    tooltip: {
        formatter: function (d) {
            // this should return the HTML contents for the tooltip
            return _.isDate(d.x) ? 'Time: ' + new Date(d.x).toTimeString().match(/\d\d:\d\d/)[0] + '<br>' + 'Measure: ' + d.y.toFixed(4) :
                'X: ' + d.x + '<br>' + 'Y: ' + d.y;
         }
    }
};


var data = _.map(coq2, function (d) {
    return {
        x: new Date(d.x),
        y: d.y
    }
})


data = [
    {
        name: 'First Series',
        data: [1000,0,3000,4000, 6000]
    },
    {
        name: 'Second Series',
        data: [1000,1000,null,1000, null]
    },
    {
        name: 'More Stuff',
        data: [4840,4000,4000,2520,3230]
    }

];

// data = [1,2,3,4,5]



new Narwhal(config)
    .cartesian()
    .horizontal()
    // .column(data)
    // .line(data)
    // .tooltip()
    .bar(data, { stacked: true })
    .stackTooltip(data, {el: '.legend' })
    .render();

</script>


</body>
</html>
