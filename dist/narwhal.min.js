/*! Narwhal - v0.0.35 - 2013-12-20 */
!function(a){var b=this;if("object"==typeof module&&module&&"object"==typeof module.exports&&"function"==typeof require&&(b.d3=require("d3"),b._=require("lodash")),!d3)throw new Error("You need to include d3.js before Narwhal. Go to http://d3js.org/");if(!_||!_.merge)throw new Error("You need to include lodash.js before Narwhal. Go to http://lodash.com/");!function(){var b={firstAndLast:function(a){return[a[0],a[a.length-1]]},roundToNearest:function(a,b){return Math.ceil(a/b)*b},niceRound:function(a){return Math.ceil(1.1*a)}},c={textBounds:function(a,b){var c=document.getElementsByTagName("body")[0],d=document.createElement("span"),e=document.createElement("span");d.className="narwhal-chart",e.style.position="absolute",e.style.width="auto",e.style.height="auto",e.style.visibility="hidden",e.style.lineHeight="100%",e.innerHTML=a,e.className=b.replace(/\./g," "),d.appendChild(e),c.appendChild(d);var f={width:e.clientWidth,height:e.clientHeight};return d.removeChild(e),c.removeChild(d),f}},d={dateDiff:function(a,b){var c=a.getTime()-b.getTime();return c/864e5}},e={merge:function(a,b){return"number"==typeof a&&(a=[a]),"number"==typeof b&&(b=[b]),a&&a.length?b&&b.length?[].concat(a,b).sort(function(a,b){return a-b}):a:b},normalizeSeries:function(a,b){function c(a,c){return{name:c,data:_.map(a,function(a,c){var d=null!=a&&a.hasOwnProperty("x"),e=b&&_.isArray(b),f=function(a){return null!=a?a:null};return d?_.extend(a,{x:a.x,y:f(a.y)}):{x:e?b[c]+"":c,y:f(a)}})}}return _.isArray(a)?_.isObject(a[0])&&a[0].hasOwnProperty("data")||_.isArray(a[0])?_.map(a,function(a,b){return c(a.data?a.data:a,a.name?a.name:"series "+(b+1))}):[c(a,"series 1")]:void 0}},f={extractScaleDomain:function(a,b,c){var d=_.max(a),e=_.min(a);return null==b&&null==c?[e,d]:null==b?[Math.min(e,c),c]:null==c?[b,Math.max(b,d)]:[b,c]}},g={selectDom:function(a){return d3.select(a)[0][0]},getStyle:function(b,c){if(!b)return a;var d="string"==typeof b?this.selectDom(b):b,e=d.offsetParent?d.ownerDocument.defaultView.getComputedStyle(d,null):d.style;return c?e[c]:e}},h={warning:function(a){console&&console.log&&console.log("WARNING: "+a)}};_.nw=_.extend({},_.nw,b,e,c,d,f,h,g)}(),function(){function b(a){return this.init(a),this}var c=this,d={chart:{animations:!0,defaultWidth:400,defaultAspect:1/1.61803398875,width:a,height:a,margin:{top:0,right:0,bottom:0,left:0},padding:{top:0,right:0,bottom:0,left:0}},xAxis:{},yAxis:{},tooltip:{}};b.expose=function(a,c){var d=function(){return _.extend(this,_.omit(c,"init")),c.init&&c.init.call(this,this.options),this};return b.prototype[a]=d,this},b.export=function(c,d){function e(a){if(!a||!a.length)return[];a[0].data&&_.each(a,e);var b=_.isObject(a[0])&&_.isDate(a[0].x),c=function(a,b){return a.x-b.x};return b&&a.sort(c),a}if("function"!=typeof d)throw new Error("Invalid render function for "+c+" visualization");b.prototype[c]=function(b,f){b=b||[],e(b),d.defaults=d.defaults||{};var g=this.options?this.options.xAxis?this.options.xAxis.categories:a:a,h={};h[c]=_.merge({},this.options[c],f),_.merge(this.options,d.defaults,h);var i;if(_.isArray(b)){var j=_.nw.normalizeSeries(b,g);this.data(j),i=_.partial(d,j)}else i=_.partial(d,b);return this.visualizations.push(i),this}},b.prototype=_.extend(b.prototype,{init:function(a){return this.options=a,this.visualizations=[],this},calculateWidth:function(){var a=_.nw.getStyle(this.options.el,"width");return this.options.el?parseInt(a,10)||this.options.chart.defaultWidth:this.options.chart.defaultWidth},calculateHeight:function(){var b=_.nw.getStyle(this.options.el,"height"),c=this.options.el?parseInt(b,10):a,d=this.options.chart.width,e=this.options.chart.aspect||this.options.chart.defaultAspect;return c?c:Math.round(d*e)},calcMetrics:function(){var a=this.options;this.adjustPadding(),this.adjustTitlePadding(),a.chart.width=a.chart.width||this.calculateWidth(),a.chart.height=a.chart.height||this.calculateHeight(),this.options=_.merge(a,{chart:{plotWidth:a.chart.width-a.chart.margin.left-a.chart.margin.right-a.chart.padding.left-a.chart.padding.right,plotHeight:a.chart.height-a.chart.margin.top-a.chart.margin.bottom-a.chart.padding.top-a.chart.padding.bottom}})},adjustPadding:function(){return this},adjustTitlePadding:function(){return this},composeOptions:function(){this.options=_.merge({},d,this.options)},baseRender:function(){return this.plotArea(),this},render:function(){return this.composeOptions(),this.calcMetrics(),this.baseRender(),this.renderVisualizations(),this},plotArea:function(){var a=this.options.chart;return this.container=d3.select(this.options.el),this.container.select("svg").remove(),this.svg=this.container.append("svg").attr("viewBox","0 0 "+a.width+" "+a.height).attr("preserveAspectRatio","xMinYMin").attr("class","narwhal-chart").attr("height",a.height).append("g").attr("transform","translate("+a.margin.left+","+a.margin.top+")"),this},createVisualizationLayer:function(a){return this.svg.append("g").attr("vis-id",a).attr("transform","translate("+this.options.chart.padding.left+","+this.options.chart.padding.top+")")},renderVisualizations:function(){return _.each(this.visualizations,function(a,b){var c=b+1,d=this.createVisualizationLayer(c);a.call(this,d,this.options,c)},this),this},compose:function(){},data:function(){}}),c.Narwhal=b}(),function(){function b(a,b){var c=b.chart.rotatedFrame?b.chart.plotWidth:b.chart.plotHeight,d=b.chart.rotatedFrame?[0,c]:[c,0];return a.range(d)}var c=function(a,b){this.data=a,this.options=b};c.prototype={axis:function(){var a=this.options.yAxis,b=this._scale.domain(),c=a.tickValues,d=this.numTicks(b,a.min,a.max),e=d3.format(a.labels.format);return d3.svg.axis().scale(this._scale).tickFormat(e).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding).ticks(d).tickValues(c)},scale:function(a){return this._scale||(this._scale=d3.scale.linear().domain(a).nice(),b(this._scale,this.options)),this._scale},numTicks:function(){return null!=this.options.yAxis.ticks?this.options.yAxis.ticks:a}},_.extend(_.nw,{YAxis:c})}(),function(){var b={chart:{gridlines:"none",padding:{top:6,bottom:25,left:0,right:5}},xAxis:{rangePadding:0,innerTickSize:0,outerTickSize:0,tickPadding:6,titlePadding:4,firstAndLast:!0,orient:"bottom",labels:{},linearDomain:!1},yAxis:{min:0,max:a,smartAxis:!0,innerTickSize:6,outerTickSize:6,tickPadding:4,titlePadding:4,orient:"left",labels:{align:"middle",format:"s"}}},c={dataSrc:[],init:function(a){return this.options=_.merge({},b,a),this.options.xAxis.firstAndLast||(this.options.chart.padding.right+=15),this},adjustPadding:function(){var a=this.options.yAxis,b=[1e4],c=d3.format(a.labels.format),d=_.map(b,c).join("<br>"),e=_.nw.textBounds(d,".y.axis"),f=_.nw.textBounds("ABC",".x.axis"),g=function(a){return Math.max(a.outerTickSize||0,a.innerTickSize||0)};this.options.chart.padding.left=g(this.options.yAxis)+(this.options.yAxis.tickPadding||0)+e.width,this.options.chart.padding.bottom=g(this.options.xAxis)+(this.options.xAxis.tickPadding||0)+f.height-4},adjustTitlePadding:function(){var a;(this.options.xAxis.title||this.options.yAxis.title)&&(this.options.xAxis.title&&(a=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),this.options.chart.padding.bottom+=a.height+this.options.xAxis.titlePadding),this.options.yAxis.title&&(a=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),this.options.chart.padding.left+=a.height+this.options.yAxis.titlePadding))},computeXScale:function(){if(!this.xDomain)throw new Error("You are trying to render without setting data (xDomain).");this.xScaleGenerator=_.nw.xScaleFactory(this.dataSrc,this.options),this.xScale=this.xScaleGenerator.scale(this.xDomain),this.rangeBand=this.xScaleGenerator.rangeBand()},computeYScale:function(){if(!this.yDomain)throw new Error("You are trying to render without setting data (yDomain).");var a=_.nw.extractScaleDomain(this.yDomain,this.options.yAxis.min,this.options.yAxis.max);this.yScaleGenerator=_.nw.yScaleFactory(this.dataSrc,this.options,this.yMin,this.yMax),this.yScale=this.yScaleGenerator.scale(a)},xScale:function(a){return a},yScale:function(a){return a},setYDomain:function(a){this.yMax||console.log(this.yMax),this.yScale.domain(a),this.options.yAxis.smartAxis||this.yScale.nice()},redrawYAxis:function(){this.svg.select(".y.axis").call(this.yAxis()),this.renderGridlines()},computeScales:function(){return this.computeXScale(),this.computeYScale(),this},xAxis:function(){return this.xScaleGenerator.axis().orient(this.options.xAxis.orient)},yAxis:function(){return this.yScaleGenerator.axis().orient(this.options.yAxis.orient)},renderXAxis:function(){var a=this.xAxis(),b=this.options.chart.plotHeight+this.options.chart.padding.top;return this._xAxisGroup=this.svg.append("g").attr("class","x axis").attr("transform","translate("+this.options.chart.padding.left+","+b+")").call(a),this.xScaleGenerator.postProcessAxis(this._xAxisGroup),this},renderYAxis:function(){var a=this.options.yAxis,b={top:".8em",middle:".35em",bottom:"0"},c=this.options.chart.padding.left,d=this.options.chart.padding.top,e=this.yAxis();return this._yAxisGroup=this.svg.append("g").attr("class","y axis").attr("transform","translate("+c+","+d+")").call(e),this._yAxisGroup.selectAll("text").attr("dy",b[a.labels.align]),this},renderAxisLabels:function(){.25*this.titleOneEm;var a,b,c,d=40/46.609;this.options.xAxis.title&&(a=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),c=this.options.chart.padding.bottom,b=0,this._xAxisGroup.append("text").attr("class","x axis-title").attr("x",b).attr("y",c).attr("dx",(this.options.chart.plotWidth-a.width)/2).attr("dy",-2).text(this.options.xAxis.title)),this.options.yAxis.title&&(a=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),c=-this.options.chart.padding.left+a.height*d,b=0,this._yAxisGroup.append("text").attr("class","y axis-title").attr("transform","rotate(-90)").attr("x",b).attr("y",c).attr("dx",-(this.options.chart.plotHeight+a.width)/2).attr("dy",0).text(this.options.yAxis.title))},renderGridlines:function(){function a(a,b){var c=a.tickValues();if(!c){var d=a.ticks()[0];return a.scale().ticks(d).slice(1)}return b&&c.pop(),c.slice(1)}function b(a){return a.tickValues()||(a.scale().ticks?a.scale().ticks().slice(1):a.scale().domain())}var c,d,e=this.options.chart.gridlines,f="horizontal"===e||"both"===e,g="vertical"===e||"both"===e,h=this.xScale,i=this.yScale;if(f){this._yAxisGroup.select("g.grid-lines").remove(),d=this._yAxisGroup.append("svg:g").attr("class","grid-lines"),c=a(this.yAxis(),this.options.yAxis.smartAxis);var j=this.options.chart.plotWidth;d.selectAll(".grid-line").data(c).enter().append("line").attr("class","grid-line").attr("x1",0).attr("x2",j).attr("y1",i).attr("y2",i)}if(g){this._xAxisGroup.select("g.grid-lines").remove(),d=this._xAxisGroup.append("svg:g").attr("class","grid-lines"),c=b(this.xAxis());var k=this.rangeBand/2,l=this.options.chart.plotHeight;d.selectAll(".grid-line").data(c).enter().append("line").attr("class","grid-line").attr("x1",function(a){return h(a)+k}).attr("x2",function(a){return h(a)+k}).attr("y1",-l).attr("y2",0)}return this},render:function(){return this.composeOptions(),this.adjustDomain(),this.calcMetrics(),this.computeScales(),this.baseRender(),this.renderXAxis().renderYAxis().renderGridlines().renderAxisLabels(),this.renderVisualizations(),this},datum:function(a,b){return _.isObject(a)&&_.isArray(a.data)?_.map(a.data,_.bind(this.datum,this)):{y:_.isObject(a)?a.y:a,x:_.isObject(a)?a.x:this.options.xAxis.categories?this.options.xAxis.categories[b]:b}},data:function(a){return a instanceof Array&&!a.length?this:(a instanceof Array&&!a[0].data?(this.dataSrc=_.map(a,_.bind(this.datum,this)),this.xDomain=this.extractXDomain(this.dataSrc),this.yDomain=this.extractYDomain(this.dataSrc),this.yMax=this.getYAxisDataMax(this.dataSrc),this.yMin=this.getYAxisDataMin(this.dataSrc)):a instanceof Array&&a[0].data&&_.each(a,function(a){this.data(a.data)},this),this)},getYAxisDataMax:function(a){return Math.max(this.yMax||0,_.max(_.pluck(a,"y")))},getYAxisDataMin:function(a){return Math.min(this.yMin||0,_.min(_.pluck(a,"y")))},extractXDomain:function(a){return this.options.xAxis.categories?this.options.xAxis.categories:_.pluck(a,"x")},extractYDomain:function(a){var b=this.yDomain?Math.max(this.yDomain[1],_.max(_.pluck(a,"y"))):_.max(_.pluck(a,"y")),c=this.yDomain?Math.min(this.yDomain[0],_.min(_.pluck(a,"y"))):_.min(_.pluck(a,"y"));return[c,b]},extractYStackedDomain:function(a){for(var b=_.pluck(a,"data"),c=_.max(b,function(a){return a.length}),d=[],e=0;c>e;e++)_.each(b,function(a){d[e]=a&&a.y?(d[e]||0)+a.y:d[e]||0});return[_.min(d),_.max(d)]},adjustDomain:function(){this.yDomain=this.yDomain?this.options.yAxis.smartAxis?[this.yDomain[0],_.nw.niceRound(this.yDomain[1])]:this.yDomain:[0,10],this.xDomain=this.xDomain?this.xDomain:[]}};Narwhal.expose("cartesian",c)}(),Narwhal.version="0.0.35",function(){var a={xScaleFactory:function(a,b){var c=_.isArray(a)&&a.length>0&&a[0].data?a[0].data[0].x&&_.isDate(a[0].data[0].x):_.isArray(a)&&a.length>0&&a[0].x&&_.isDate(a[0].x);return c&&"ordinal"!==b.xAxis.type?new _.nw.TimeScale(a,b):"linear"===b.xAxis.type?new _.nw.LinearScale(a,b):new _.nw.OrdinalScale(a,b)},yScaleFactory:function(a,b,c,d){return b&&b.yAxis&&b.yAxis.smartAxis?new _.nw.SmartYAxis(a,b,c,d):new _.nw.YAxis(a,b)}};_.nw=_.extend({},_.nw,a)}(),function(){function a(a,b){this.options=b,this.data=a,this.init()}a.prototype={init:function(){delete this._scale},scale:function(a){return this._domain=a?this._getAxisDomain(a):this._getAxisDomain(this.data),this._scale||(this._scale=d3.scale.linear().domain(this._domain),null==this.options.xAxis.min&&null==this.options.xAxis.max&&this._scale.nice(),this._setRange()),this._scale},axis:function(){var a=this.options.xAxis,b=d3.format(a.labels.format||"d"),c=d3.svg.axis().scale(this._scale).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding).tickFormat(function(a){return _.isDate(a)?a.getDate():b(a)});return this.options.xAxis.firstAndLast&&c.tickValues(_.nw.firstAndLast(this._domain)),c},rangeBand:function(){return 1},postProcessAxis:function(){return this},_setRange:function(){var a=this.options.chart.rotatedFrame?this.options.chart.plotHeight:this.options.chart.plotWidth,b=this.options.chart.rotatedFrame?[a,0]:[0,a];return this._scale.range(b)},_getAxisDomain:function(a){var b=this.options.xAxis.min,c=this.options.xAxis.max,d=null!=b?this.options.xAxis.min:d3.min(a),e=null!=c?this.options.xAxis.max:d3.max(a);return null!=b&&null!=c&&b>c?d3.extent(a):[d,e]}},_.nw=_.extend({},_.nw,{LinearScale:a})}(),function(){function a(a,b){this.options=b,this.data=a,this.init()}a.prototype={init:function(){this.isCategorized=!0,delete this._scale},scale:function(a){return this._domain=a,this._scale||(this._scale=(new d3.scale.ordinal).domain(a),this._range()),this._scale},axis:function(){var a=this.options.xAxis,b=d3.svg.axis().scale(this._scale).innerTickSize(a.innerTickSize).outerTickSize(a.outerTickSize).tickPadding(a.tickPadding).tickValues(this.options.xAxis.categories).tickFormat(function(a){return _.isDate(a)?a.getDate():a});return this.options.xAxis.firstAndLast&&b.tickValues(_.nw.firstAndLast(this._domain)),b},postProcessAxis:function(){},rangeBand:function(){return this._scale.rangeBand()},_range:function(){var a=this.options.chart.rotatedFrame?[this.options.chart.plotHeight,0]:[0,this.options.chart.plotWidth];return this.isCategorized?this._scale.rangeRoundBands(a,.1):this._scale.rangePoints(a)}},_.nw=_.extend({},_.nw,{OrdinalScale:a})}(),function(){function a(a,b,c,d,e){var f=_.nw.merge(a,e);return null==b&&null==c?f:null==b?c>d?_.nw.merge([c],f):[c]:null==c?b>=e?[b]:(f[0]=b,f):_.nw.merge([b,c],e)}var b=function(a,b,c,d){this.data=a,this.options=b,this.yMax=d,this.yMin=c};b.prototype=_.extend({},_.nw.YAxis.prototype,{axis:function(){var b=this.options.yAxis,c=this._scale.domain(),d=a(c,b.min,b.max,this.yMin,this.yMax),e=this.numTicks(),f=d3.format(b.labels.format),g=b.orient;return d3.svg.axis().scale(this.scale()).tickFormat(f).tickSize(b.innerTickSize,b.outerTickSize).tickPadding(b.tickPadding).orient(g).ticks(e).tickValues(d)},numTicks:function(){return 3}}),_.extend(_.nw,{SmartYAxis:b})}(),function(){function a(a,b){var c=a.getTime()-b.getTime();return c/864e5}function b(a,b){this.options=b,this.data=a,this.init()}b.prototype={init:function(){delete this._scale},scale:function(a){this._domain=a;var b=this._getAxisDomain(a);return this._scale||(this._scale=(new d3.time.scale).domain(b),this.range()),this._scale},axis:function(){var a=this.options.xAxis,b=this.getOptimalTickFormat(),c=d3.svg.axis().scale(this._scale).tickFormat(b).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding).tickValues(this._domain);if(null!=this.options.xAxis.maxTicks&&this.options.xAxis.maxTicks<this._domain.length){for(var d=[],e=this._domain.length,f=(e+1)/this.options.xAxis.maxTicks,g=0,h=0;e>g;g+=f,h+=f)d.push(this._domain[Math.min(Math.ceil(h),e-1)]);c.tickValues(d)}else this.options.xAxis.firstAndLast&&c.tickValues(_.nw.firstAndLast(this._domain));return c},postProcessAxis:function(a){if(this.options.xAxis.firstAndLast){var b=a.selectAll(".tick text")[0];d3.select(b[0]).style({"text-anchor":"start"}),d3.select(b[b.length-1]).style({"text-anchor":"end"})}},rangeBand:function(){return 4},getOptimalTickFormat:function(){if(this.options.xAxis.labels.formatter)return this.options.xAxis.labels.formatter;var b=a(this._domain[this._domain.length-1],this._domain[0]),c=this.options.xAxis.maxTicks||5;return c>b?d3.time.format("%H:%M"):d3.time.format("%d %b")},range:function(){var a=this._getAxisRange(this._domain);return this._scale.rangeRound(a,.1)},_getAxisDomain:function(a){return this.options.xAxis.linearDomain?a:d3.extent(a)},_getAxisRange:function(a){var b=this.options.chart.rotatedFrame?this.options.chart.plotHeight:this.options.chart.plotWidth;return this.options.xAxis.linearDomain?_.range(0,b,b/(a.length-1)).concat([b]):[0,b]}},_.nw=_.extend({},_.nw,{TimeScale:b})}(),function(){var a={chart:{rotatedFrame:!0},xAxis:{orient:"left"},yAxis:{orient:"bottom"}},b={init:function(){_.merge(this.options,a)},adjustPadding:function(){var a=this.options.xAxis.categories||_.pluck(this.dataSrc,"x"),b=a.join("<br>"),c=_.nw.textBounds(b,".x.axis"),d=_.nw.textBounds("ABC",".y.axis"),e=function(a){return Math.max(a.outerTickSize,a.innerTickSize)};this.options.chart.padding.left=e(this.options.xAxis)+this.options.xAxis.tickPadding+c.width,this.options.chart.padding.bottom=e(this.options.yAxis)+this.options.yAxis.tickPadding+d.height},adjustTitlePadding:function(){var a;(this.options.xAxis.title||this.options.yAxis.title)&&(this.options.xAxis.title&&(a=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),this.options.chart.padding.left+=a.height+this.options.xAxis.titlePadding),this.options.yAxis.title&&(a=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),this.options.chart.padding.bottom+=a.height+this.options.yAxis.titlePadding))},renderYAxis:function(){var a=this.yAxis(),b=this.options.chart.padding.left,c=this.options.chart.padding.top+this.options.chart.plotHeight;return this._yAxisGroup=this.svg.append("g").attr("class","y axis").attr("transform","translate("+b+","+c+")").call(a),this},renderXAxis:function(){var a=this.options.chart.padding.left,b=this.options.chart.padding.top,c=this.xAxis();return this._xAxisGroup=this.svg.append("g").attr("class","x axis").attr("transform","translate("+a+","+b+")").call(c),this.xScaleGenerator.postProcessAxis(this._xAxisGroup),this},renderAxisLabels:function(){var a,b,c,d,e,f,g=.25*this.titleOneEm,h=40/46.609;this.options.xAxis.title&&(a=_.nw.textBounds(this.options.xAxis.title,".x.axis-title"),e=this.options.chart.rotatedFrame?-a.height:this.options.chart.plotWidth,f=this.options.chart.rotatedFrame?-this.options.chart.padding.left:this.options.chart.padding.bottom-g,c=this.options.chart.rotatedFrame?"-90":"0",this._xAxisGroup.append("text").attr("class","x axis-title").attr("x",0).attr("y",f).attr("transform",["rotate(",c,")"].join("")).attr("dy",a.height*h).attr("dx",-(this.options.chart.plotHeight+a.width)/2).text(this.options.xAxis.title)),this.options.yAxis.title&&(a=_.nw.textBounds(this.options.yAxis.title,".y.axis-title"),d=Math.max(this.options.yAxis.innerTickSize,this.options.yAxis.outerTickSize),b=this.options.chart.rotatedFrame?"end":"middle",e=this.options.chart.rotatedFrame?this.options.chart.plotWidth:0,f=this.options.chart.rotatedFrame?this.options.chart.padding.bottom:-this.options.chart.padding.left+this.titleOneEm-g,c=this.options.chart.rotatedFrame?"0":"-90",this._yAxisGroup.append("text").attr("class","y axis-title").attr("y",f).attr("x",e).attr("dx",-(this.options.chart.plotWidth+a.width)/2).attr("dy",-4).attr("transform",["rotate(",c,")"].join("")).text(this.options.yAxis.title))}};Narwhal.expose("horizontal",b)}(),function(){function a(a,b){function c(){if(this.options.area.stacked&&null==this.options.yAxis.max){var a=_.flatten(_.map(i,function(a){return a.data})),b=_.max(a,function(a){return a.y0+a.y});this.setYDomain([0,b.y+b.y0]),this.redrawYAxis()}}function d(){var a=b.selectAll("g.series").data(i).enter().append("g").attr("class",g);a.append("path").datum(function(a){return a.data}).attr("class","area").attr("d",j)}var e=_.bind(function(a){return this.xScale(a)+this.rangeBand/2},this),f=_.bind(function(a){return this.yScale(a)},this),g=function(a,b){return"series s-"+(b+1)+" "+a.name},h=d3.layout.stack().values(function(a){return a.data}),i=h(a),j=d3.svg.area().x(function(a){return e(a.x)}).y0(function(a){return f(a.y0)}).y1(function(a){return f(a.y0+a.y)});c.call(this),d.call(this)}var b={xAxis:{type:"linear"},area:{stacked:!0}};a.defaults=b,Narwhal.export("area",a)}(),function(){function a(a,b,c){function d(b){if(null==this.options.yAxis.max){var c=_.flatten(_.map(a,function(a){return a.data})),d=_.max(c,function(a){return a.y0+a.y});this.setYDomain([0,d.y+d.y0]),this.redrawYAxis()}return b.attr("y",function(a){return g(a.x)}).attr("height",i).attr("x",function(a){return h(a.y0||0)}).attr("width",function(a){return h(a.y)})}function e(){var a=function(){return i/m-f.padding},b=function(a,b){return i/m*b};return o.attr("y",function(a,c,d){return g(a.x)+b(a,d)}).attr("height",a).attr("x",function(){return h(0)}).attr("width",function(a){return h(a.y)})}var f=c.bar,g=this.xScale,h=this.yScale,i=this.rangeBand,j=function(a,b){return"series s-"+(b+1)+" "+a.name},k=d3.layout.stack().values(function(a){return a.data}),l=c.bar.stacked?d:e,m=a.length,n=b.selectAll("g.series").data(k(a)).enter().append("svg:g").attr("class",j),o=n.selectAll(".bar").data(function(a){return a.data}).enter().append("rect").attr("class","bar tooltip-tracker");l.call(this,o)}var b={bar:{stacked:!1,padding:2}};a.defaults=b,Narwhal.export("bar",a)}(),function(){function a(a,b,c){function d(b){if(null==this.options.yAxis.max){var c=_.flatten(_.map(a,function(a){return a.data})),d=_.max(c,function(a){return a.y0+a.y});this.setYDomain([0,d.y+d.y0]),this.redrawYAxis()}b.attr("x",function(a){return h(a.x)}).attr("width",function(){return j}).attr("y",function(a){return i(a.y)+i(a.y0)-g}).attr("height",function(a){return g-i(a.y)})}function e(b){var c=j/a.length-f.padding,d=function(b,c){return j/a.length*c};b.attr("x",function(a,b,c){return h(a.x)+d(a,c)}).attr("width",c).attr("y",function(a){return i(a.y)}).attr("height",function(a){return g-i(a.y)})}var f=c.column,g=this.options.chart.plotHeight,h=this.xScale,i=this.yScale,j=this.rangeBand,k=function(a,b){return"series s-"+(b+1)+" "+a.name},l=d3.layout.stack().values(function(a){return a.data}),m=this.options.column.stacked?d:e,n=b.selectAll("g.series").data(l(a)).enter().append("g").attr("class",k),o=n.selectAll(".column").data(function(a){return a.data});o.enter().append("rect").attr("class","column tooltip-tracker"),m.call(this,o)}var b={column:{stacked:!1,padding:1}};a.defaults=b,Narwhal.export("column",a)}(),function(){Narwhal.export("coolNarwhal",function(a,b){b.append("path").attr("class","cool").attr("opacity",0).attr("transform","scale(.5) translate(500 150)").attr("d","M-220.02,76.509l-0.78,8.927c-0.956,10.949,1.389,20.422,6.188,30.383c10.203,21.173,63.095,84.05,93.72,115.075c20.145,20.406,19.487,23.018,21.549,40.122c2.487,20.621,24.897,66.462,40.838,71.269 c15.086,4.549,12.91-12.398,13.319-37.83c5.746,2.457,10.917,5.638,20.206,12.697c61.697,46.892,139.734,69.97,206.5,71.733c46.209,1.221,81.432-7.081,142.957-33.694c40.484-17.512,54.271-22.098,65.639-21.504c4.432,0.232,22.678,11.204,41.746,21.563c35.398,19.229,69.457,34.595,75.896,34.239c12.609-1.457-0.701-11.783-8.072-24.217c-7.049-11.892-15.414-29.572-18.844-42.134s-4.723-22.272-8.91-27.091c-2.143-2.463-12.812-6.786-21.189-8.146c-18.045-2.933-22.191-2.922-13.531-8.957c13.076-9.115,17.377-11.039,1.826-29.068c-6.383-7.402-11.336-20.003-13.709-39.542c-1.607-13.237,1.057-23.679-3.869-27.451s-17.271,12.341-20.846,19.334c-2.01,3.937-7.102,19.005-11.312,33.485c-13.795,47.427-29.865,65.742-62.693,71.447c-34.361,5.971-71.623-9.506-116.543-48.404c-13.164-11.399-29.533-25.26-39.254-36.913c-13.428-16.101-15.48-18.138-19.785-20.66c-16.166-9.472-54.98-31.694-103.525-63.815c-24.393-16.141-57.72-36.928-71.453-43.693c-27.236-13.417-68.416-28.952-90.731-46.771c-24.665-19.697-38.108-19.793-67.804-5.479c-21.429,10.328-23.941,15.298-26.52,15.726c-8.216-10.129-22.917-11.198-31.647-20.682c-9.529-10.35-28.027-14.098-37.824-24.957c-10.668-11.826-31.25-16.752-40.886-26.94c-11.339-11.989-29.387-16.096-40.838-26.637c-11.617-10.694-27.159-14.843-37.68-24.045c-10.383-9.082-23.187-12.538-31.408-19.163c-8.193-6.601-16.593-9.444-22.026-11.993c-5.433-2.549-7.398-2.522-7.658-1.927c-0.26,0.594,1.355,2.955,6.054,6.447c4.699,3.491,22.193,18.451,31.645,22.77c10.921,5.104,17.502,15.01,29.671,21.375c13.224,6.918,22.212,18.731,36.229,25.924c15.53,7.971,24.754,21.184,39.657,28.253c16.462,7.808,25.503,21.598,39.958,28.36c14.499,6.78,20.647,20.252,34.429,23.428C-238.033,58.207-227.932,70.443-220.02,76.509L-220.02,76.509z").transition().delay(300).duration(2e3).attr("opacity",1)})}(),function(){function a(a,b,c,d){function e(a,c,e){function i(){n[0]&&s.attr("d",h(n[0])).transition().duration(600).attrTween("d",m)}function j(){s.attr("d",h)}function k(){b.append("g").attr("class","line-chart-markers").selectAll("dot").data(n).enter().append("circle").attr("class","dot "+p).attr("r",o).attr("cx",f).attr("cy",g)}function l(){var a=10;b.append("g").attr("class","tooltip-trackers").selectAll("tooltip-tracker").data(n).enter().append("circle").attr("class","tooltip-tracker").attr("opacity",0).attr("r",a).attr("cx",f).attr("cy",g)}function m(){var a=n,b=d3.scale.quantile().domain([0,1]).range(d3.range(1,a.length+1));return function(c){return h(a.slice(0,b(c)))}}c=c?c.replace(/\s/,"_"):"";var n=_.filter(a,function(a){return null!=a.y}),o=this.options.line.marker.size,p=["v-"+d,"s-"+e,c].join(" "),q=this.options.chart.animations?i:j,r=this.options.line.marker.enable?k:_.noop,s=b.append("path").datum(n).attr("class","line "+p);q(),r(),l()}var f=_.bind(function(a){return this.xScale(a.x)+this.rangeBand/2},this),g=_.bind(function(a){return this.yScale(a.y)},this),h=d3.svg.line().x(function(a){return f(a)}).y(function(a){return g(a)});return this.options.line.smooth&&h.interpolate("cardinal"),_.each(a,function(a,b){e.call(this,a.data,a.name,b+1)},this),this}var b={line:{smooth:!1,marker:{enable:!0,size:2.5}}};a.defaults=b,Narwhal.export("line",a)}(),function(){function a(a,b){function c(a){var c=b.append("svg:g").attr("transform","translate("+(g+f)+","+(g+f)+")");c.selectAll(".series").data(i(a.data)).enter().append("path").attr("class",h).attr("d",j)}var d=this.options.chart.plotWidth,e=this.options.chart.plotHeight,f=this.options.pie.piePadding,g=this.options.pie.outerRadius||Math.min(d,e)/2-f,h=function(a,b){return"series arc tooltip-tracker s-"+(b+1)+" "+a.name},i=d3.layout.pie().value(function(a){return a.y}),j=d3.svg.arc().outerRadius(g).innerRadius(this.options.pie.innerRadius);a.length>1&&_.nw.warning("pie chart only supports 1 series at a time"),_.each(a,c,this)}var b={pie:{piePadding:10,innerRadius:null,outerRadius:null}};a.defaults=b,Narwhal.export("pie",a)}(),function(){function a(a,b,c){function d(a,c){var d=function(){return a.name+" s-"+(c+1)},f=b.append("g").attr("class",d);f.selectAll("dot").data(a.data).enter().append("circle").attr("class","dot tooltip-tracker").attr("r",e.radius).attr("cx",g).attr("cy",h)}var e=c.scatter,f=this.rangeBand/2,g=_.bind(function(a){return this.xScale(a.x)+f},this),h=_.bind(function(a){return this.yScale(a.y)},this);_.each(a,d)}var b={xAxis:{type:"linear"},scatter:{radius:4}};a.defaults=b,Narwhal.export("scatter",a)}(),function(){Narwhal.export("stackTooltip",function(a,b,c){var d=this.yAxis().tickFormat(),e=d3.select(c.stackTooltip.el);e.classed("stack-tooltip",!0);var f=function(b){var f=function(a){return!(a&&null!=a.y)},g=function(a,d){var e=_.isNumber(b.x)?b.x:c.xAxis.categories.indexOf(b.x);return f(a.data[e])?null:{seriesName:a.name,value:a.data[e].y,cssClass:"s-"+(d+1)}},h=_.filter(_.map(a,g),function(a){return a}),i=_.map(h,function(a){return'<span class="'+a.cssClass+'"">'+a.seriesName+": "+d(a.value)+"</span>"}).join(" / ");e.html(i).style({display:"block"})},g=function(){e.html("")};this.svg.selectAll(".tooltip-tracker").on("mouseover.tooltip",f.bind(this)).on("mouseout.tooltip",g.bind(this))})}(),function(){function a(){var a=function(){clearTimeout(this.tooltip.hideTimer)},b=function(a,b){this.options.tooltip.animate?this.tooltipElement.transition().duration(b).style("opacity",a):this.tooltipElement.style("opacity",a)},c=function(a){return{x:a.pageX+10,y:a.pageY-10}},d=function(a){var b=d3.event,d=c(b);g.call(this,a,d)},e=function(){b.call(this,0,this.options.tooltip.hideTime)},f=function(a){return this.options.tooltip.formatter?this.options.tooltip.formatter.call(this,a):"x: "+a.x+"<br>"+"y: "+a.y},g=function(c,d){a.call(this);var e=f.call(this,c);this.tooltipElement.select(".text").html(e),this.tooltipElement.style("top",d.y+"px").style("left",d.x+"px"),b.call(this,this.options.tooltip.visibleOpacity,this.options.tooltip.showTime)};this.tooltipElement=this.container.append("div"),this.tooltipElement.attr("class","nw-tooltip").style("opacity",0).append("div").attr("class","text"),this.svg.selectAll(".tooltip-tracker").on("mouseover.tooltip",d.bind(this)).on("mouseout.tooltip",e.bind(this))}var b={tooltip:{animate:!0,visibleOpacity:.75,showTime:300,hideTime:500}};a.defaults=b,Narwhal.export("tooltip",a)}(),function(){function a(a,b){return b="undefined"==typeof b?!0:b,this.parse(a,b),this._dimension=0,this}a.prototype={parse:function(a,b){if(this._data=[],this._headers=[],a&&a.length){var c=a.split(/\n\r?/);this._headers=b?_.each(c.shift().split(","),function(a){return a.toLowerCase()}):_.range(0,c[0].length),_.each(c,function(a){this._data.push(a.split(","))},this)}},dimension:function(a){return arguments.length?(this._dimension=this._headers.indexOf(a.toLowerCase()),this):this._headers[this._dimension]},measure:function(a){return this.data(a.toLowerCase())},data:function(a){var b=this._dimension,c=this._headers.indexOf(a),d=_.map(this._data,function(a){return{x:a[b],y:_.isNaN(+a[c])?a[c]:+a[c]}});return d}},Narwhal.connectors=Narwhal.connectors||{},Narwhal.connectors.Csv=a}(),"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=Narwhal:(b.Narwhal=Narwhal,"function"==typeof define&&define.amd&&define("narwhal",[],function(){return Narwhal}))}();
//# sourceMappingURL=dist/narwhal.min.map