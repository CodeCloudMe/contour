/*! Narwhal - v0.0.1 - 2013-10-21 */
!function(a,b,c,d,e){function f(a){return this.init(a),this}var g={chart:{defaultWidth:400,defaultAspect:1/1.61803398875,width:e,height:e,margin:{top:0,right:0,bottom:0,left:0},padding:{top:0,right:0,bottom:0,left:0}}};f.export=function(a,b){if("function"!=typeof b)throw new Error("Invalid constructor for "+a+" visualization");f.prototype[a]=b},f.utils={textBounds:function(a,b){var c=document.getElementsByTagName("body")[0],d=document.createElement("span"),e=document.createElement("span");d.className="narwhal-chart",e.style.position="absolute",e.style.left=-9999,e.innerHTML=a,e.className=b,d.appendChild(e),c.appendChild(d);var f={width:e.clientWidth,height:e.clientHeight};return e.remove(),d.remove(),f}},f.prototype=c.extend(f.prototype,{init:function(a){return this.options=a,this.visualizations=[],this},calculateWidth:function(){return parseInt(d(this.options.el).width(),10)||this.options.chart.defaultWidth},calculateHeight:function(){var a=parseInt(d(this.options.el).height(),10),b=this.options.chart.width,c=this.options.chart.aspect||this.options.chart.defaultAspect;return a?a:Math.round(b*c)},calcMetrics:function(){var a=this.options;a.chart.width=a.chart.width||this.calculateWidth(),a.chart.height=a.chart.height||this.calculateHeight(),this.options=d.extend(!0,a,{chart:{plotWidth:a.chart.width-a.chart.margin.left-a.chart.margin.right-a.chart.padding.left-a.chart.padding.right,plotHeight:a.chart.height-a.chart.margin.top-a.chart.margin.bottom-a.chart.padding.top-a.chart.padding.bottom}})},composeOptions:function(){this.options=d.extend(!0,{},g,this.options)},baseRender:function(){return this.plotArea(),this},render:function(){return this.composeOptions(),this.calcMetrics(),this.baseRender(),this.renderVisualizations(),this},plotArea:function(){var a=this.options.chart;return this.container=b.select(this.options.el),this.svg=this.container.append("svg").attr("width",a.width).attr("height",a.height).attr("class","narwhal-chart").append("g").attr("transform","translate("+a.margin.left+","+a.margin.top+")"),this},renderVisualizations:function(){return c.each(this.visualizations,function(a,b){a.id=b+1,a.call(this,this.svg)},this),this},expose:function(a,b){var d={},e=function(){return c.extend(this,c.omit(b,"init")),b.init&&b.init.call(this,this.options),this};return d[a]=e,c.extend(this,d),this},compose:function(){}}),window[a]=f}("Narwhal",window.d3,window._,window.jQuery),function(a,b,c,d,e){function f(a,b){return a&&a.length?b&&b.length?[].concat(a,b).sort(function(a,b){return a-b}):a:b}function g(a,b,c){return b===e&&c===e?a:b===e?c>a[0]?f([c],a):[c]:c===e?b<a[a.length-1]?f([b],a):[b]:f([b,c],a)}function h(a,b,c){return b===e&&c===e?a:b===e?[Math.min(a[0],c),c]:c===e?[b,Math.max(b,a[a.length-1])]:[b,c]}var i={chart:{padding:{top:10,bottom:20,left:20,right:2}},xAxis:{rangePadding:0,innerTickSize:0,outerTickSize:0,tickPadding:8,titlePadding:6},yAxis:{min:e,max:e,innerTickSize:0,outerTickSize:6,tickPadding:8,titlePadding:10,labels:{format:".0f"}}},j={init:function(a){if(this.options=d.extend(!0,{},i,a),this.options.xAxis.title||this.options.yAxis.title){var b=Narwhal.utils.textBounds("ABCD","axis-title").height;this.options.xAxis.title&&(this.options.chart.padding.bottom+=b),this.options.yAxis.title&&(this.options.chart.padding.left+=b)}return this},computeXScale:function(){if(!this.xDomain)throw new Error("You are trying to render without setting data (xDomain).");var a=h(this.xDomain,this.options.xAxis.min,this.options.xAxis.max);this.xScale=b.scale.ordinal().domain(a).rangePoints([0,this.options.chart.plotWidth]),this.rangeBand=this.xScale.rangeBand()},computeYScale:function(){if(!this.yDomain)throw new Error("You are trying to render without setting data (yDomain).");var a=h(this.yDomain,this.options.yAxis.min,this.options.yAxis.max);this.yScale=b.scale.linear().domain(a).range([this.options.chart.plotHeight,0])},computeScales:function(){return this.computeXScale(),this.computeYScale(),this},xAxis:function(){var a=this.options.chart.plotHeight+this.options.chart.padding.top,c=this.options.xAxis,d=b.svg.axis().scale(this.xScale).tickSize(c.innerTickSize,c.outerTickSize).tickPadding(c.tickPadding).orient("bottom");return this.svg.append("g").attr("class","x axis").attr("transform","translate("+this.options.chart.padding.left+","+a+")").call(d).select("text").attr("text-anchor","start").select("text:last-child").attr("text-anchor","end"),this},yAxis:function(){var a=this.options.yAxis,c=g(this.yDomain,a.min,a.max),d=b.format(a.labels.format),e=b.svg.axis().scale(this.yScale).tickValues(c).tickFormat(d).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding).orient("left");return this.svg.append("g").attr("class","y axis").attr("transform","translate("+this.options.chart.padding.left+","+this.options.chart.padding.top+")").call(e).selectAll("text").attr("dy",".9em"),this},axisLabels:function(){this.options.xAxis.title&&this.svg.append("text").attr("class","x axis-title").attr("text-anchor","end").attr("x",this.options.chart.width).attr("y",this.options.chart.height).attr("dx",-this.options.chart.padding.right).attr("dy",-this.options.xAxis.titlePadding).text(this.options.xAxis.title),this.options.yAxis.title&&this.svg.append("text").attr("class","y axis-title").attr("text-anchor","end").attr("transform","rotate(-90)").attr("x",0).attr("y","1em").attr("dx",-this.options.yAxis.titlePadding).attr("dy",0).text(this.options.yAxis.title)},render:function(){return this.composeOptions(),this.calcMetrics(),this.computeScales(),this.baseRender(),this.renderVisualizations(),this.xAxis().yAxis().axisLabels(),this},datum:function(a,b){return{y:c.isObject(a)?a.y:a,x:c.isObject(a)?a.x:b}},data:function(a){if(a instanceof Array&&!a[0].data){var b=c.map(a,this.datum);this.dataSrc=b,this.xDomain=c.pluck(b,"x");var d=this.yDomain?Math.max(this.yDomain[1],c.max(c.pluck(b,"y"))):c.max(c.pluck(b,"y")),e=this.yDomain?Math.max(this.yDomain[0],c.min(c.pluck(b,"y"))):c.min(c.pluck(b,"y"));this.yDomain=[e,d]}else a instanceof Array&&a[0].data&&c.each(a,function(a){this.data(a.data)},this);return this}};window[a].prototype.expose("cartesian",j)}("Narwhal",window.d3,window._,window.jQuery),function(a,b,c,d){function e(a,e){d.extend(!0,this.options,f,{line:e}),this.data(a);var g=function(d){function e(a,b){b=b||"not-specified",className=b.replace(" ","_"),j.append("path").datum(a).attr("class","line series-"+className).attr("d",i),this.options.line.marker.enable&&j.append("g").attr("class","line-chart-markers").selectAll("dot").data(a).enter().append("circle").attr("class","dot tooltip-tracker series-"+className).attr("r",3).attr("cx",f).attr("cy",h)}var f=c.bind(function(a){return this.xScale(a.x)+this.rangeBand/2},this),h=c.bind(function(a){return this.yScale(a.y)},this),i=b.svg.line().x(function(a){return f(a)}).y(function(a){return h(a)}),j=d.append("g").attr("vis-id",g.id).attr("type","line-chart").attr("transform","translate("+this.options.chart.padding.left+","+this.options.chart.padding.top+")");return a[0].data?c.each(a,function(a){var b=c.map(a.data,this.datum,this);e.call(this,b,a.name)},this):e.call(this,c.map(a,this.datum)),this};return this.visualizations.push(g),this}var f={line:{marker:{enable:!0}}};Narwhal.export("line",e)}("Narwhal",window.d3,window._,window.jQuery);
//# sourceMappingURL=dist/narwhal.min.map